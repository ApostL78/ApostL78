name: Metrics

on:
  schedule:
    - cron: "0 4 * * *"
  workflow_dispatch:
  push:
    branches: ["main"]

jobs:
  github-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:

      # Current year — 3D isometric calendar
      - name: Isocalendar (current year)
        if: ${{ success() || failure() }}
        uses: lowlighter/metrics@latest
        with:
          filename: isocalendar.svg
          token: ${{ secrets.METRICS_TOKEN }}
          base: ""
          config_include: public
          plugin_isocalendar: yes
          plugin_isocalendar_duration: half-year

      # 2022-2025 pixel art — flat commit calendar
      - name: Calendar (pixel art years)
        if: ${{ success() || failure() }}
        uses: lowlighter/metrics@latest
        with:
          filename: calendar.svg
          token: ${{ secrets.METRICS_TOKEN }}
          base: ""
          config_include: public
          plugin_calendar: yes
          plugin_calendar_limit: 5

      # Pinned repositories
      - name: Pinned Repositories
        if: ${{ success() || failure() }}
        uses: lowlighter/metrics@latest
        with:
          filename: repositories.svg
          token: ${{ secrets.METRICS_TOKEN }}
          base: ""
          plugin_repositories: yes
          plugin_repositories_pinned: 6


      # Starlists
      - name: Starlists
        if: ${{ success() || failure() }}
        uses: lowlighter/metrics@latest
        with:
          filename: starlists.svg
          token: NOT_NEEDED
          base: ""
          user: ApostL78
          plugin_starlists: yes
          plugin_starlists_limit: 2
          plugin_starlists_languages: yes

      # LeetCode
      - name: LeetCode
        if: ${{ success() || failure() }}
        uses: lowlighter/metrics@latest
        with:
          filename: leetcode.svg
          token: NOT_NEEDED
          base: ""
          user: ApostL78
          plugin_leetcode: yes
          plugin_leetcode_sections: solved, skills
